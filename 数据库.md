# 数据库系统原理

## 一、事务
概念：事务是一个满足ACID特性的操作序列，不可分割的工作单元，以begin transaction开始，以rollback/commit结束。

**ACID:**
* Atomicity（原子性）：事务被视为不可分割的最小单元，要么全部提交成功，要么全部失败回滚。
* consistency（一致性）：数据库在事务执行前后都保持一致性状态，在一致性状态下，所有事务对同一个数据读取结果都是一样的
* Isolation（隔离性）：一个事务所做的修改在最终提交之前，对其他事务不可见。
* Durability(持久性）：一旦事务提交，则其所做的修改就会永久地保存在数据库中。即使系统崩溃，事务执行的结果也不会消失。
系统崩溃后，可以用**重做日志**进行恢复，从而实现持久性。

## 二、并发一致性问题
**在并发环境下，事务的隔离性很难保证，因此会出现很多并发一致性问题**

### 丢失修改
T1 先修改，T2 随后修改，T2 的修改覆盖了 T1 的修改。

![](https://tva1.sinaimg.cn/large/007S8ZIlgy1gf12pfu7hyj30tu0hiaaq.jpg)

### 读脏数据
T1 修改一个数据，T2 随后读取这个数据。如果 T1 撤销了这次修改，那么 T2 读取的数据是脏数据。造成两个事务得到的数据不一致；

![](https://tva1.sinaimg.cn/large/007S8ZIlgy1gf138bgayaj30r10mygmh.jpg)

### 幻读
